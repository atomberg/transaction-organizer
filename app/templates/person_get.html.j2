{% extends "base.html.j2" %}
{% block title %}Index{% endblock %}

{% block scripts %}
<script type="text/javascript">
    
</script>
{% endblock %}

{% block content %}
<div class="row">
    <div class="col-lg-12 text-center">
        <h1>{{ person['full_name'] }}</h1>
        {# <p class="lead">Would you like to edit me or add some notes?</p> #}
    </div>
</div>
<!-- /.row -->

<div class="row">
    <table id="table_id" class="table">
        <tbody>
            <tr>
                <th>Name</th>
                <td>{{ person['full_name'] }}</td>
                <td rowspan="4">{{ person['notes'] }}</td>
            </tr>
            <tr>
                <th>Email</th>
                <td>{{ person['email'] }}</td>
            </tr>
            <tr>
                <th>Phone number</th>
                <td>{{ person['phone'] }}</td>
            </tr>
            <tr>
                <th>Address</th>
                <td>{{ person['address'] }}</td>
            </tr>
            <tr>
                <th>Actions</th>
                <td>
                    <a href="{{ url_for('persons.edit', person_id=person['id']) }}" class="btn btn-info">
                    Edit <i class="fa fa-chevron-right"></i></a>
                </td>
                <td>
                    <div class="row">
                        <i>Last modified {{ person['last_modified'] }}</i>
                    </div>
                    <div class="row">
                        <i>Created on {{ person['created_at'] }}</i>
                    </div>
                </td>
            </tr>
        </tbody>
    </table>
</div>
<hr>
<div class="row">
    <div class="col-lg-12">
        <h2> Transactions </h2> 
        <p class="lead">
            {{person.transactions|length}} transactions for 
            a total amount of ${{person.transactions | sum(attribute='amount', start=0) | currency_format}}
        </p>
    </div>
  <table id="last_transactions_table" class="table table-striped table-bordered" cellspacing="0" width="100%">
    <thead>
      <tr>
        <th>Date</th>
        <th>Method</th>
        <th>Amount</th>
        <th>Accepted by</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for transaction in person.transactions %}
      <tr>
        <td>{{ transaction.date }}</td>
        <td>{{ transaction.method }}</td>
        <td>{{ transaction.amount | currency_format}}</td>
        <td>{{ transaction.accepted_by }}</td>
        <td>
          <a href="{{ url_for('transactions.get', transaction_id=transaction.id) }}" class="btn btn-info">
            View <i class="fa fa-chevron-right"></i>
          </a>
          {% if transaction.notes %}
          <i class="fa fa-tag" style="color:mediumvioletred"></i>
          {% endif %}
        </td>
      </tr>
      {% endfor %}
    </tbody>
  </table>
</div>
{% endblock %}