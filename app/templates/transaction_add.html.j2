{% extends "base.html.j2" %}
{% block title %}Transaction input{% endblock %}

{% block scripts %}
<script type="text/javascript">
  $(document).ready(function () {
    $("#people-nav").removeClass("active");
    $("#transactions-nav").removeClass("active");
    $("#add-person-nav").removeClass("active");
    $("#add-transaction-nav").addClass("active");
  });
</script>
{% endblock %}

{% block content %}
<div class="row">
  <div class="col-lg-12 text-center">
    <h1>Latest transactions</h1>
    <p class="lead">Why not add a new transaction now?</p>
  </div>
</div>

<div class="row">
  <table id="last_transactions_table" class="table table-striped table-bordered" cellspacing="0">
    <thead>
      <tr>
        <th>Person ID</th>
        <th>Date</th>
        <th>Method</th>
        <th>Amount</th>
        <th>Accepted by</th>
        <th>Memo</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      {% for transaction in transactions %}
      <tr>
        <td>{{ transaction.person.full_name }}</td>
        <td>{{ transaction.date }}</td>
        <td>{{ transaction.method }}</td>
        <td>{{ transaction.amount | currency_format }}</td>
        <td>{{ transaction.accepted_by }}</td>
        <td>{{ transaction.memo or '' }}</td>
        <td>
          <a href="{{ url_for('transactions.get', transaction_id=transaction.id) }}" class="btn btn-success btn-sm">
            <i class="fa fa-pencil"></i> Edit
          </a>
        </td>
      </tr>
      {% endfor %}
      <form id="add" method="post" action="{{ url_for('transactions.add') }}">
        <tr>
          <td>
            <select class="selectpicker persons form-control" data-live-search="true" name="person_id" form="add" 
               id="person-input-id" placeholder="Person" list="persons">
              {% for id, person in persons %}
              <option value="{{ id }}">{{ person }}</option>
              {% endfor %}
            </select>
          </td>
          <td>
            <input name="day" form="add" class="form-control" type="date" value="{{ today }}">
          </td>
          <td>
            <input name="method" form="add" class="methods form-control" id="method-input-id" type="text"
              placeholder="Method" list="methods">
            <datalist id="methods">
              <option value="Cash"></option>
              <option value="Debit"></option>
              <option value="Credit"></option>
            </datalist>
          </td>
          <td>
            <input name="amount" form="add" class="form-control" type="text" placeholder="Amount">
          </td>
          <td>
            <input name="accepted_by" form="add" class="accepted_bys form-control" id="accepted_by-input-id" type="text"
              placeholder="Accepted by" list="accepted_bys">
            <datalist id="accepted_bys">
              {% for by in accepted_bys %}
              <option value="{{ by }}"></option>
              {% endfor %}
            </datalist>
          </td>
          <td>
            <input name="memo" form="add" class="form-control" type="text" placeholder="Memo">
          </td>
          <td>
            <button type="submit" form="add" class="btn btn-success btn-sm">
              <i class="fa fa-plus-circle"></i> Add
            </button>
          </td>
        </tr>
      </form>
    </tbody>
  </table>
</div>

<div class="row">

</div>
{% endblock %}